$('#<%= @location_id %> <%= @coverage_type %>.selected-plan').html("<%= escape_javascript(render(partial: "employers/plan_years/plan_selection/plan_details")).html_safe %>")
$("#<%= @location_id %> <%= @coverage_type %>.selected-plan h2.employer-monthly-cost").html("<%= number_to_currency(@employer_contribution_amount.to_f) %>");
$("#<%= @location_id %> <%= @coverage_type %>.selected-plan .employee-monthly-cost-min").html("<%= number_to_currency(@min_employee_cost.to_f) %>");
$("#<%= @location_id %> <%= @coverage_type %>.selected-plan .employee-monthly-cost-max").html("<%= number_to_currency(@max_employee_cost.to_f) %>");
$("#<%= @location_id %> <%= @coverage_type %>.selected-plan").show();
$("#<%= @location_id %> <%= @coverage_type %> .reference-steps").show();
$("#<%= @location_id %> .edit-offering").hide();
$("#<%= @location_id %> <%= @coverage_type %> .reference-steps .dental .nav-tabs").hide();
$("#<%= @location_id %> <%= @coverage_type %>.selected-plan .row:first").hide();
$("#<%= @location_id %> .dental .reference-steps div:first").hide()
$("#<%= @location_id %> <%= @coverage_type %> .col-md-12.top-pd").hide();
$('#<%= @location_id %> .dental-benefits-fields .col-xs-6.form-group.form-group-lg label > input').attr('disabled', 'disabled');


$(".change-dental-reference-plan").show();

if (window.location.href.indexOf("edit") > -1 && window.location.href.indexOf("plan_years") > -1) {
  if ( '<%= @coverage_type %>' == '.dental' ) {
    $("#<%= @location_id %> .dental .change-dental-reference-plan").on('click', function() {
      $("#<%= @location_id %> .dental .nav-tabs input[type=radio]").removeAttr('checked');
      $(this).closest('.selected-plan').hide();
      $(this).closest('#<%= @location_id %>').find('.dental .edit-offering, .dental .nav-tabs').show();
      $('#<%= @location_id %> <%= @coverage_type %> .currently-offered').html('You currently offer <%= @plan.name %>.');
      $('#<%= @location_id %> <%= @coverage_type %> .currently-offering').html('You currently offer <%= @plan.name %>.');
      var newLocationId = $(this).closest('.benefit-group-fields').attr('id');
      $('#<%= @location_id %> .dental .plan-options a').each(function() {
        var url = $(this).attr('href');
        $(this).attr('href', url+"&location_id="+newLocationId);
      });

    });
  } else {
    $("#<%= @location_id %> .health .health .change-dental-reference-plan").on('click', function() {
      $(this).closest('.selected-plan').hide();
      $(this).closest('#<%= @location_id %>').find('.reference-steps:first').show();
      $('#<%= @location_id %> .reference-steps:first .currently-offered').html('You currently offer <%= @plan.name %>.');
      $('#<%= @location_id %> .reference-steps:first .currently-offering').html('You currently offer <%= @plan.name %>.');
    });

  }
  $("#<%= @location_id %> <%= @coverage_type %> #employer_cost_info_btn .btn, #<%= @location_id %> <%= @coverage_type %> #edit_employer_cost_info_btn").click(function(){
   var location_id = $(this).parents('.benefit-group-fields').attr('id');

   if ( $(this).closest('.health').length > 0 ) {
     var coverage_type = '.health';
     var reference_plan_id = $("#<%= @location_id %> .health .ref-plan").val();
   } else {
     var coverage_type = '.dental';
     var reference_plan_id = $("#<%= @location_id %> .dental .dental-ref-plan").val();
   }

   if (reference_plan_id == "" || reference_plan_id == undefined) {
     return
   }
   console.log(reference_plan_id+" "+coverage_type+" "+location_id);
   calcEmployerContributions($('a#employee_costs_link').attr('href'), location_id, coverage_type);
 });

} else {

}
// $(function() {
//   $("#employer_cost_info_btn .btn").click(function(){
//     $('.cost-impact-loader').show();
//     calcEmployerContributions($('a#employee_costs_link').attr('href'));
//   })
// })
