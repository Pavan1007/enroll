<div class="module container broker_quote_tool">
  <div class="row">
    <div class="col-md-12">
        <h2>Broker Quoting Tool</h2>

        <%= form_tag(broker_agencies_quotes_root_path, method: :get) do  %>

       <input name='employee' value='50' type='hidden'>
       <input name='spouse' value='0' type='hidden'>
       <input name='domestic_partner' value='0' type='hidden'>
       <input name='child_under_26' value='0' type='hidden'>
       <input name='child_26_and_over' value='0' type='hidden'>
       <%= hidden_field_tag(rb_emp: '777') %>

       <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="false">
       	<div class="panel panel-default">
       		<div class="panel-heading" role="tab" id="quote-mgmt-header">
       				<a role="button" data-toggle="collapse" data-parent="#accordion" href="#quote-mgmt" aria-expanded="false" aria-controls="quote-mgmt">
       					Quote/Roster Management <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
       				</a>
       		</div>
       	  <div id="quote-mgmt" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="">

            <%=render "my_quotes" , quote_results: @quote_results %>

       	  </div>
       	</div>
        <br>

        	<div class="panel panel-default">
        		<div class="panel-heading" role="tab" id="feature-mgmt-header">
        				<a role="button" data-toggle="collapse" data-parent="#accordion" href="#feature-mgmt" aria-expanded="true" aria-controls="feature-mgmt">
        					Features and cost criteria <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
        				</a>
        		</div>
        	  <div id="feature-mgmt" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="">

            <%= render partial: 'my_features' %>

        	  </div>
        	</div>
        <!--<a data-toggle="collapse" href="#collapseExample1" aria-expanded="true" aria-controls="collapseExample1" >
            <div class='well edge'>Features and cost criteria
                <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
            </div>
        </a>
         <div class="collapse in" id="collapseExample1">
            <= render partial: 'my_features' >
         </div>-->

        <!--<a data-toggle="collapse" href="#collapseExample2" aria-expanded="false" aria-controls="collapseExample2" >
            <div class='well edge'>Select plans
                <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
                <span class="glyphicon glyphicon-triangle-right"> </span>
                <span style='margin-left: 50px; font-size: 120%;'  id='show_plan_selected_count'>Plan count</span>
                <label class='btn btn-normal' id='reset_selections'> Reset</label>

            </div>
        </a>-->

          <div class="panel panel-default">
        		<div class="panel-heading" role="tab" id="plan-selection-mgmt-header">
        				<a role="button" data-toggle="collapse" data-parent="#accordion" href="#plan-selection-mgmt" aria-expanded="true" aria-controls="plan-selection-mgmt">
        					Plan Selection <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
        				</a>
        		</div>
        	  <div id="plan-selection-mgmt" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="">



            	<%= render partial: 'my_plans' %>

        	  </div>
        	</div>


        <% end %>
    <%if @qhps%>
    <div class="panel panel-default">
      <div class="panel-collapse collapse in" role="tabpanel" aria-labelledby="">
        <%=render "plan_comparision" , qhps: @qhps %>
      </div>
    </div>
    <%end%>
    <% if @quote_results %>
      <div class="panel panel-default">
        <div class="panel-collapse collapse in" role="tabpanel" aria-labelledby="">
       <%=render "quote_comparision" , quote_results: @quote_results %>
      </div>
    </div>
    <% end %>
      </div>
    </div>
  </div>
</div>

<script type="text/javascript">

$('.plan_selectors .criteria').on('click',function(){
                              selected=this; sibs = $(selected).siblings();
                              $.each(sibs, function(){ this.className='criteria' }) ;
                              selected.className='active';
                              console.log('selection triggered. plans available: ' + window.select_plans.length);
                            })

$(document).on('ready page:load', function () {
    setTimeout(function(){
    //bootstrapslider labels will have zero width unless the sliders are initially visible before being hidden
      $('[aria-controls="collapseExample1"]').attr('aria-expanded', false)
      $('#collapseExample1').removeClass('in')
    }, 0)
    setTimeout(function(){
    //bootstrapslider labels will have zero width unless the sliders are initially visible before being hidden
      $('[aria-controls="collapseExample"]').attr('aria-expanded', false)
      $('#collapseExample').removeClass('in')
    }, 0)
    window.select_plans = <%=raw @plan_quote_criteria %>
    var select_deductible = 0
    select_deductible = <%= @max_deductible %>
    deductible_value = select_deductible
    plan_count = window.select_plans.length
    $('.plan_selectors .criteria').on('click', function() {
      toggle_plans()
    })
    window.relationship_benefits = <%= raw @benefit_pcts_json %>
    slider_listeners()
})
</script>
